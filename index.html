<!doctype html>
<html>
<head>
<title> HTML Page</title>
<meta name="description" content="Our first page">
<meta name="keywords" content="html tutorial template">
</head>
<body>
Content goes here.
</body>


<script>
const endpoint = 'https://api.entur.io/journey-planner/v3/graphql';
const query = `{
  board1: stopPlaces(ids: ["NSR:StopPlace:6488"]) {
    name
    estimatedCalls(whiteListedModes: [rail,bus,metro,tram,water], numberOfDepartures: 200, arrivalDeparture: departures, timeRange: 14400) {
      realtime
      serviceJourney {
        id
      }
      quay {
        publicCode
        id
        stopPlace {
          parent {
            id
          }
          id
        }
      }
      expectedDepartureTime
      actualDepartureTime
      aimedDepartureTime
      destinationDisplay {
        frontText
      }
      serviceJourney {
        id
        line {
          id
          publicCode
          transportMode
        }        
      }
    }
  }
  
}`;
const makeQuery = async () => {
  const response = await fetch(endpoint, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ query }),
  });

  return await response.json();


};

let queryResult;

makeQuery()
  .then((result) => {
    queryResult = result;


    processQueryResult(queryResult) 
  })
  .catch((error) => {
    console.error(error);
  });


function processQueryResult(queryResult) {
    const estimatedCalls = queryResult.data.board1[0].estimatedCalls.length
    for (let i = 0; i < estimatedCalls; i++) {
        if ("Vestli" == queryResult.data.board1[0].estimatedCalls[i].destinationDisplay.frontText) {
            console.log(queryResult.data.board1[0].estimatedCalls[i].destinationDisplay.frontText)
            console.log
            console.log(queryResult.data.board1[0].estimatedCalls[i].aimedDepartureTime)
            console.log("")
        }
    }
}

</script>


</html>
